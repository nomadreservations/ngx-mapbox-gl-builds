!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("mapbox-gl"),require("tslib"),require("@turf/bbox"),require("@turf/helpers"),require("rxjs/AsyncSubject"),require("rxjs/operators/first"),require("rxjs/Subscription"),require("rxjs/observable/fromEvent"),require("rxjs/observable/merge"),require("rxjs/operators/startWith"),require("supercluster"),require("rxjs/operators/takeUntil"),require("rxjs/ReplaySubject"),require("rxjs/operators/debounceTime"),require("rxjs/Subject")):"function"==typeof define&&define.amd?define(["exports","@angular/common","@angular/core","mapbox-gl","tslib","@turf/bbox","@turf/helpers","rxjs/AsyncSubject","rxjs/operators/first","rxjs/Subscription","rxjs/observable/fromEvent","rxjs/observable/merge","rxjs/operators/startWith","supercluster","rxjs/operators/takeUntil","rxjs/ReplaySubject","rxjs/operators/debounceTime","rxjs/Subject"],e):e(t["ngx-mapbox-gl"]={},t.ng.common,t.ng.core,t.mapboxgl,t.tslib,t.turfbbox,t.turfhelpers,t.Rx,t.Rx.Observable.prototype,t.Rx,t.Rx.Observable,t.Rx.Observable,t.Rx.Observable.prototype,t.supercluster,t.Rx.Observable.prototype,t.Rx,t.Rx.Observable.prototype,t.Rx)}(this,function(t,e,n,o,r,i,a,s,u,p,c,m,h,l,d,f,y,g){"use strict";i=i&&i.hasOwnProperty("default")?i["default"]:i,l=l&&l.hasOwnProperty("default")?l["default"]:l;var v=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),"throw":s(1),"return":s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},b=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},I=new n.InjectionToken("MapboxApiKey"),C=function(){function t(t,e){this.zone=t,this.MAPBOX_API_KEY=e,this.mapCreated=new s.AsyncSubject,this.mapLoaded=new s.AsyncSubject,this.layerIdsToRemove=[],this.sourceIdsToRemove=[],this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new p.Subscription,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}return t.prototype.setup=function(t){var e=this;this.zone.onStable.pipe(u.first()).subscribe(function(){e.assign(o,"accessToken",t.accessToken||e.MAPBOX_API_KEY),t.customMapboxApiUrl&&e.assign(o,"config.API_URL",t.customMapboxApiUrl),e.createMap(t.mapOptions),e.hookEvents(t.mapEvents),e.mapEvents=t.mapEvents,e.mapCreated.next(undefined),e.mapCreated.complete()})},t.prototype.destroyMap=function(){this.subscription.unsubscribe(),this.mapInstance.remove()},t.prototype.updateMinZoom=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.setMinZoom(t)})},t.prototype.updateMaxZoom=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.setMaxZoom(t)})},t.prototype.updateScrollZoom=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.scrollZoom.enable():e.mapInstance.scrollZoom.disable()})},t.prototype.updateDragRotate=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.dragRotate.enable():e.mapInstance.dragRotate.disable()})},t.prototype.updateTouchZoomRotate=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.touchZoomRotate.enable():e.mapInstance.touchZoomRotate.disable()})},t.prototype.updateDoubleClickZoom=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.doubleClickZoom.enable():e.mapInstance.doubleClickZoom.disable()})},t.prototype.updateKeyboard=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.keyboard.enable():e.mapInstance.keyboard.disable()})},t.prototype.updateDragPan=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.dragPan.enable():e.mapInstance.dragPan.disable()})},t.prototype.updateBoxZoom=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.boxZoom.enable():e.mapInstance.boxZoom.disable()})},t.prototype.updateStyle=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.setStyle(t)})},t.prototype.updateMaxBounds=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.setMaxBounds(t)})},t.prototype.changeCanvasCursor=function(t){this.mapInstance.getCanvasContainer().style.cursor=t},t.prototype.queryRenderedFeatures=function(t,e){return this.mapInstance.queryRenderedFeatures(t,e)},t.prototype.panTo=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.panTo(t)})},t.prototype.move=function(t,e,n,o,r,i){var a=this;return this.zone.runOutsideAngular(function(){a.mapInstance[t](Object.assign({},e,{zoom:n||a.mapInstance.getZoom(),center:o||a.mapInstance.getCenter(),bearing:r||a.mapInstance.getBearing(),pitch:i||a.mapInstance.getPitch()}))})},t.prototype.addLayer=function(t,e){var n=this;this.zone.runOutsideAngular(function(){Object.keys(t.layerOptions).forEach(function(e){var n=e;t.layerOptions[n]===undefined&&delete t.layerOptions[n]}),n.mapInstance.addLayer(t.layerOptions,e),t.layerEvents.click.observers.length&&n.mapInstance.on("click",t.layerOptions.id,function(e){n.zone.run(function(){t.layerEvents.click.emit(e)})}),t.layerEvents.mouseEnter.observers.length&&n.mapInstance.on("mouseenter",t.layerOptions.id,function(e){n.zone.run(function(){t.layerEvents.mouseEnter.emit(e)})}),t.layerEvents.mouseLeave.observers.length&&n.mapInstance.on("mouseleave",t.layerOptions.id,function(e){n.zone.run(function(){t.layerEvents.mouseLeave.emit(e)})}),t.layerEvents.mouseMove.observers.length&&n.mapInstance.on("mousemove",t.layerOptions.id,function(e){n.zone.run(function(){t.layerEvents.mouseMove.emit(e)})})})},t.prototype.removeLayer=function(t){this.layerIdsToRemove.push(t)},t.prototype.addMarker=function(t){var e=this;return this.zone.runOutsideAngular(function(){t.addTo(e.mapInstance)})},t.prototype.removeMarker=function(t){this.markersToRemove.push(t)},t.prototype.addPopup=function(t){var e=this;return this.zone.runOutsideAngular(function(){t.addTo(e.mapInstance)})},t.prototype.removePopup=function(t){this.popupsToRemove.push(t)},t.prototype.addControl=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){n.mapInstance.addControl(t,e)})},t.prototype.removeControl=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.removeControl(t)})},t.prototype.loadAndAddImage=function(t,e,n){return r.__awaiter(this,void 0,void 0,function(){var o=this;return v(this,function(r){return[2,this.zone.runOutsideAngular(function(){return new Promise(function(r,i){o.mapInstance.loadImage(e,function(e,a){e?i(e):(o.addImage(t,a,n),r())})})})]})})},t.prototype.addImage=function(t,e,n){var o=this;return this.zone.runOutsideAngular(function(){o.mapInstance.addImage(t,e,n)})},t.prototype.removeImage=function(t){this.imageIdsToRemove.push(t)},t.prototype.addSource=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){Object.keys(e).forEach(function(t){return e[t]===undefined&&delete e[t]}),n.mapInstance.addSource(t,e)})},t.prototype.getSource=function(t){return this.mapInstance.getSource(t)},t.prototype.removeSource=function(t){this.sourceIdsToRemove.push(t)},t.prototype.setAllLayerPaintProperty=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){Object.keys(e).forEach(function(o){n.mapInstance.setPaintProperty(t,o,e[o])})})},t.prototype.setAllLayerLayoutProperty=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){Object.keys(e).forEach(function(o){n.mapInstance.setLayoutProperty(t,o,e[o])})})},t.prototype.setLayerFilter=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){n.mapInstance.setFilter(t,e)})},t.prototype.setLayerBefore=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){n.mapInstance.moveLayer(t,e)})},t.prototype.setLayerZoomRange=function(t,e,n){var o=this;return this.zone.runOutsideAngular(function(){o.mapInstance.setLayerZoomRange(t,e||0,n||20)})},t.prototype.fitBounds=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){n.mapInstance.fitBounds(t,e)})},t.prototype.getCurrentViewportBbox=function(){var t=this.mapInstance.getCanvas(),e=t.width,n=t.height,o=this.mapInstance.unproject([0,0]).toArray(),r=this.mapInstance.unproject([e,0]).toArray(),s=this.mapInstance.unproject([e,n]).toArray(),u=this.mapInstance.unproject([0,n]).toArray();return i(a.polygon([[o,r,s,u,o]]))},t.prototype.applyChanges=function(){var t=this;this.zone.runOutsideAngular(function(){t.removeLayers(),t.removeSources(),t.removeMarkers(),t.removePopups(),t.removeImages()})},t.prototype.createMap=function(t){var e=this;n.NgZone.assertNotInAngularZone(),Object.keys(t).forEach(function(e){var n=e;t[n]===undefined&&delete t[n]}),this.mapInstance=new o.Map(t);var r=this.zone.onMicrotaskEmpty.subscribe(function(){return e.applyChanges()});this.subscription.add(r)},t.prototype.removeLayers=function(){try{for(var t=b(this.layerIdsToRemove),e=t.next();!e.done;e=t.next()){var n=e.value;this.mapInstance.off("click",n),this.mapInstance.off("mouseenter",n),this.mapInstance.off("mouseleave",n),this.mapInstance.off("mousemove",n),this.mapInstance.removeLayer(n)}}catch(i){o={error:i}}finally{try{e&&!e.done&&(r=t["return"])&&r.call(t)}finally{if(o)throw o.error}}var o,r;this.layerIdsToRemove=[]},t.prototype.removeSources=function(){try{for(var t=b(this.sourceIdsToRemove),e=t.next();!e.done;e=t.next()){var n=e.value;this.mapInstance.removeSource(n)}}catch(i){o={error:i}}finally{try{e&&!e.done&&(r=t["return"])&&r.call(t)}finally{if(o)throw o.error}}var o,r;this.sourceIdsToRemove=[]},t.prototype.removeMarkers=function(){try{for(var t=b(this.markersToRemove),e=t.next();!e.done;e=t.next()){e.value.remove()}}catch(r){n={error:r}}finally{try{e&&!e.done&&(o=t["return"])&&o.call(t)}finally{if(n)throw n.error}}var n,o;this.markersToRemove=[]},t.prototype.removePopups=function(){try{for(var t=b(this.popupsToRemove),e=t.next();!e.done;e=t.next()){e.value.remove()}}catch(r){n={error:r}}finally{try{e&&!e.done&&(o=t["return"])&&o.call(t)}finally{if(n)throw n.error}}var n,o;this.popupsToRemove=[]},t.prototype.removeImages=function(){try{for(var t=b(this.imageIdsToRemove),e=t.next();!e.done;e=t.next()){var n=e.value;this.mapInstance.removeImage(n)}}catch(i){o={error:i}}finally{try{e&&!e.done&&(r=t["return"])&&r.call(t)}finally{if(o)throw o.error}}var o,r;this.imageIdsToRemove=[]},t.prototype.hookEvents=function(t){var e=this;this.mapInstance.on("load",function(){e.mapLoaded.next(undefined),e.mapLoaded.complete(),e.zone.run(function(){return t.load.emit(e.mapInstance)})}),t.resize.observers.length&&this.mapInstance.on("resize",function(){return e.zone.run(function(){return t.resize.emit()})}),t.remove.observers.length&&this.mapInstance.on("remove",function(){return e.zone.run(function(){return t.remove.emit()})}),t.mouseDown.observers.length&&this.mapInstance.on("mousedown",function(n){return e.zone.run(function(){return t.mouseDown.emit(n)})}),t.mouseUp.observers.length&&this.mapInstance.on("mouseup",function(n){return e.zone.run(function(){return t.mouseUp.emit(n)})}),t.mouseMove.observers.length&&this.mapInstance.on("mousemove",function(n){return e.zone.run(function(){return t.mouseMove.emit(n)})}),t.click.observers.length&&this.mapInstance.on("click",function(n){return e.zone.run(function(){return t.click.emit(n)})}),t.dblClick.observers.length&&this.mapInstance.on("dblclick",function(n){return e.zone.run(function(){return t.dblClick.emit(n)})}),t.mouseEnter.observers.length&&this.mapInstance.on("mouseenter",function(n){return e.zone.run(function(){return t.mouseEnter.emit(n)})}),t.mouseLeave.observers.length&&this.mapInstance.on("mouseleave",function(n){return e.zone.run(function(){return t.mouseLeave.emit(n)})}),t.mouseOver.observers.length&&this.mapInstance.on("mouseover",function(n){return e.zone.run(function(){return t.mouseOver.emit(n)})}),t.mouseOut.observers.length&&this.mapInstance.on("mouseout",function(n){return e.zone.run(function(){return t.mouseOut.emit(n)})}),t.contextMenu.observers.length&&this.mapInstance.on("contextmenu",function(n){return e.zone.run(function(){return t.contextMenu.emit(n)})}),t.touchStart.observers.length&&this.mapInstance.on("touchstart",function(n){return e.zone.run(function(){return t.touchStart.emit(n)})}),t.touchEnd.observers.length&&this.mapInstance.on("touchend",function(n){return e.zone.run(function(){return t.touchEnd.emit(n)})}),t.touchMove.observers.length&&this.mapInstance.on("touchmove",function(n){return e.zone.run(function(){return t.touchMove.emit(n)})}),t.touchCancel.observers.length&&this.mapInstance.on("touchcancel",function(n){return e.zone.run(function(){return t.touchCancel.emit(n)})}),t.moveStart.observers.length&&this.mapInstance.on("movestart",function(n){return e.zone.run(function(){return t.moveStart.emit(n)})}),t.move.observers.length&&this.mapInstance.on("move",function(n){return e.zone.run(function(){return t.move.emit(n)})}),t.moveEnd.observers.length&&this.mapInstance.on("moveend",function(n){return e.zone.run(function(){return t.moveEnd.emit(n)})}),t.dragStart.observers.length&&this.mapInstance.on("dragstart",function(n){return e.zone.run(function(){return t.dragStart.emit(n)})}),t.drag.observers.length&&this.mapInstance.on("drag",function(n){return e.zone.run(function(){return t.drag.emit(n)})}),t.dragEnd.observers.length&&this.mapInstance.on("dragend",function(n){return e.zone.run(function(){return t.dragEnd.emit(n)})}),t.zoomStart.observers.length&&this.mapInstance.on("zoomstart",function(n){return e.zone.run(function(){return t.zoomStart.emit(n)})}),t.zoomEvt.observers.length&&this.mapInstance.on("zoom",function(n){return e.zone.run(function(){return t.zoomEvt.emit(n)})}),t.zoomEnd.observers.length&&this.mapInstance.on("zoomend",function(n){return e.zone.run(function(){return t.zoomEnd.emit(n)})}),t.rotateStart.observers.length&&this.mapInstance.on("rotatestart",function(n){return e.zone.run(function(){return t.rotateStart.emit(n)})}),t.rotate.observers.length&&this.mapInstance.on("rotate",function(n){return e.zone.run(function(){return t.rotate.emit(n)})}),t.rotateEnd.observers.length&&this.mapInstance.on("rotateend",function(n){return e.zone.run(function(){return t.rotateEnd.emit(n)})}),t.pitchStart.observers.length&&this.mapInstance.on("pitchstart",function(n){return e.zone.run(function(){return t.pitchStart.emit(n)})}),t.pitchEvt.observers.length&&this.mapInstance.on("pitch",function(n){return e.zone.run(function(){return t.pitchEvt.emit(n)})}),t.pitchEnd.observers.length&&this.mapInstance.on("pitchend",function(n){return e.zone.run(function(){return t.pitchEnd.emit(n)})}),t.boxZoomStart.observers.length&&this.mapInstance.on("boxzoomstart",function(n){return e.zone.run(function(){return t.boxZoomStart.emit(n)})}),t.boxZoomEnd.observers.length&&this.mapInstance.on("boxzoomend",function(n){return e.zone.run(function(){return t.boxZoomEnd.emit(n)})}),t.boxZoomCancel.observers.length&&this.mapInstance.on("boxzoomcancel",function(n){return e.zone.run(function(){return t.boxZoomCancel.emit(n)})}),t.webGlContextLost.observers.length&&this.mapInstance.on("webglcontextlost",function(){return e.zone.run(function(){return t.webGlContextLost.emit()})}),t.webGlContextRestored.observers.length&&this.mapInstance.on("webglcontextrestored",function(){return e.zone.run(function(){return t.webGlContextRestored.emit()})}),t.render.observers.length&&this.mapInstance.on("render",function(){return e.zone.run(function(){return t.render.emit()})}),t.error.observers.length&&this.mapInstance.on("error",function(){return e.zone.run(function(){return t.error.emit()})}),t.data.observers.length&&this.mapInstance.on("data",function(n){return e.zone.run(function(){return t.data.emit(n)})}),t.styleData.observers.length&&this.mapInstance.on("styledata",function(n){return e.zone.run(function(){return t.styleData.emit(n)})}),t.sourceData.observers.length&&this.mapInstance.on("sourcedata",function(n){return e.zone.run(function(){return t.sourceData.emit(n)})}),t.dataLoading.observers.length&&this.mapInstance.on("dataloading",function(n){return e.zone.run(function(){return t.dataLoading.emit(n)})}),t.styleDataLoading.observers.length&&this.mapInstance.on("styledataloading",function(n){return e.zone.run(function(){return t.styleDataLoading.emit(n)})}),t.sourceDataLoading.observers.length&&this.mapInstance.on("sourcedataloading",function(n){return e.zone.run(function(){return t.sourceDataLoading.emit(n)})})},t.prototype.assign=function(t,e,n){if("string"==typeof e&&(e=e.split(".")),e.length>1){var o=e.shift();this.assign(t[o]="[object Object]"===Object.prototype.toString.call(t[o])?t[o]:{},e,n)}else t[e[0]]=n},t}();C.decorators=[{type:n.Injectable}],C.ctorParameters=function(){return[{type:n.NgZone},{type:undefined,decorators:[{type:n.Optional},{type:n.Inject,args:[I]}]}]};var S=function(){function t(t){this.container=t}return t.prototype.onAdd=function(){return this.container},t.prototype.onRemove=function(){return this.container.parentNode.removeChild(this.container)},t.prototype.getDefaultPosition=function(){return"top-right"},t}(),O=function(){function t(t){this.MapService=t}return t.prototype.ngAfterContentInit=function(){var t=this;this.content.nativeElement.childNodes.length&&(this.control=new S(this.content.nativeElement),this.MapService.mapCreated$.subscribe(function(){t.MapService.addControl(t.control,t.position)}))},t.prototype.ngOnDestroy=function(){this.MapService.removeControl(this.control)},t}();O.decorators=[{type:n.Component,args:[{selector:"mgl-control",template:'<div class="mapboxgl-ctrl" #content><ng-content></ng-content></div>',changeDetection:n.ChangeDetectionStrategy.OnPush}]}],O.ctorParameters=function(){return[{type:C}]},O.propDecorators={position:[{type:n.Input}],content:[{type:n.ViewChild,args:["content"]}]};var E=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapCreated$.subscribe(function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");var e={};t.compact!==undefined&&(e.compact=t.compact),t.ControlComponent.control=new o.AttributionControl(e),t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)})},t}();E.decorators=[{type:n.Directive,args:[{selector:"[mglAttribution]"}]}],E.ctorParameters=function(){return[{type:C},{type:O,decorators:[{type:n.Host}]}]},E.propDecorators={compact:[{type:n.Input}]};var x=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapCreated$.subscribe(function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");t.ControlComponent.control=new o.FullscreenControl,t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)})},t}();x.decorators=[{type:n.Directive,args:[{selector:"[mglFullscreen]"}]}],x.ctorParameters=function(){return[{type:C},{type:O,decorators:[{type:n.Host}]}]};var M=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapCreated$.subscribe(function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");var e={positionOptions:t.positionOptions,fitBoundsOptions:t.fitBoundsOptions,trackUserLocation:t.trackUserLocation,showUserLocation:t.showUserLocation};Object.keys(e).forEach(function(t){var n=t;e[n]===undefined&&delete e[n]}),t.ControlComponent.control=new o.GeolocateControl(e),t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)})},t}();M.decorators=[{type:n.Directive,args:[{selector:"[mglGeolocate]"}]}],M.ctorParameters=function(){return[{type:C},{type:O,decorators:[{type:n.Host}]}]},M.propDecorators={positionOptions:[{type:n.Input}],fitBoundsOptions:[{type:n.Input}],trackUserLocation:[{type:n.Input}],showUserLocation:[{type:n.Input}]};var z=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapCreated$.subscribe(function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");t.ControlComponent.control=new o.NavigationControl,t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)})},t}();z.decorators=[{type:n.Directive,args:[{selector:"[mglNavigation]"}]}],z.ctorParameters=function(){return[{type:C},{type:O,decorators:[{type:n.Host}]}]};var w=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapCreated$.subscribe(function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");var e={};t.maxWidth!==undefined&&(e.maxWidth=t.maxWidth),t.unit!==undefined&&(e.unit=t.unit),t.ControlComponent.control=new o.ScaleControl(e),t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)})},t}();w.decorators=[{type:n.Directive,args:[{selector:"[mglScale]"}]}],w.ctorParameters=function(){return[{type:C},{type:O,decorators:[{type:n.Host}]}]},w.propDecorators={maxWidth:[{type:n.Input}],unit:[{type:n.Input}]};var k=function(){function t(t,e){this.MapService=t,this.zone=e,this.error=new n.EventEmitter,this.loaded=new n.EventEmitter,this.imageAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){return r.__awaiter(t,void 0,void 0,function(){var t,e=this;return v(this,function(n){switch(n.label){case 0:return this.data?(this.MapService.addImage(this.id,this.data,this.options),this.imageAdded=!0,[3,5]):[3,1];case 1:if(!this.url)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.MapService.loadAndAddImage(this.id,this.url,this.options)];case 3:return n.sent(),this.imageAdded=!0,this.zone.run(function(){e.loaded.emit()}),[3,5];case 4:return t=n.sent(),this.zone.run(function(){e.error.emit(t)}),[3,5];case 5:return[2]}})})})},t.prototype.ngOnChanges=function(t){(t.data&&!t.data.isFirstChange()||t.options&&!t.options.isFirstChange()||t.url&&!t.url.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.imageAdded&&this.MapService.removeImage(this.id)},t}();k.decorators=[{type:n.Component,args:[{selector:"mgl-image",template:""}]}],k.ctorParameters=function(){return[{type:C},{type:n.NgZone}]},k.propDecorators={id:[{type:n.Input}],data:[{type:n.Input}],options:[{type:n.Input}],url:[{type:n.Input}],error:[{type:n.Output}],loaded:[{type:n.Output}]};var D=function(){function t(t){this.MapService=t,this.click=new n.EventEmitter,this.mouseEnter=new n.EventEmitter,this.mouseLeave=new n.EventEmitter,this.mouseMove=new n.EventEmitter,this.layerAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){t.MapService.addLayer({layerOptions:{id:t.id,type:t.type,source:t.source,metadata:t.metadata,"source-layer":t.sourceLayer,minzoom:t.minzoom,maxzoom:t.maxzoom,filter:t.filter,layout:t.layout,paint:t.paint},layerEvents:{click:t.click,mouseEnter:t.mouseEnter,mouseLeave:t.mouseLeave,mouseMove:t.mouseMove}},t.before),t.layerAdded=!0})},t.prototype.ngOnChanges=function(t){this.layerAdded&&(t.paint&&!t.paint.isFirstChange()&&this.MapService.setAllLayerPaintProperty(this.id,t.paint.currentValue),t.layout&&!t.layout.isFirstChange()&&this.MapService.setAllLayerLayoutProperty(this.id,t.layout.currentValue),t.filter&&!t.filter.isFirstChange()&&this.MapService.setLayerFilter(this.id,t.filter.currentValue),t.before&&!t.before.isFirstChange()&&this.MapService.setLayerBefore(this.id,t.before.currentValue),(t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange())&&this.MapService.setLayerZoomRange(this.id,this.minzoom,this.maxzoom))},t.prototype.ngOnDestroy=function(){this.layerAdded&&this.MapService.removeLayer(this.id)},t}();D.decorators=[{type:n.Component,args:[{selector:"mgl-layer",template:""}]}],D.ctorParameters=function(){return[{type:C}]},D.propDecorators={id:[{type:n.Input}],source:[{type:n.Input}],type:[{type:n.Input}],metadata:[{type:n.Input}],sourceLayer:[{type:n.Input}],filter:[{type:n.Input}],layout:[{type:n.Input}],paint:[{type:n.Input}],before:[{type:n.Input}],minzoom:[{type:n.Input}],maxzoom:[{type:n.Input}],click:[{type:n.Output}],mouseEnter:[{type:n.Output}],mouseLeave:[{type:n.Output}],mouseMove:[{type:n.Output}]};var P=function(){function t(t){this.MapService=t,this.movingMethod="flyTo",this.resize=new n.EventEmitter,this.remove=new n.EventEmitter,this.mouseDown=new n.EventEmitter,this.mouseUp=new n.EventEmitter,this.mouseMove=new n.EventEmitter,this.click=new n.EventEmitter,this.dblClick=new n.EventEmitter,this.mouseEnter=new n.EventEmitter,this.mouseLeave=new n.EventEmitter,this.mouseOver=new n.EventEmitter,this.mouseOut=new n.EventEmitter,this.contextMenu=new n.EventEmitter,this.touchStart=new n.EventEmitter,this.touchEnd=new n.EventEmitter,this.touchMove=new n.EventEmitter,this.touchCancel=new n.EventEmitter,this.moveStart=new n.EventEmitter,this.move=new n.EventEmitter,this.moveEnd=new n.EventEmitter,this.dragStart=new n.EventEmitter,this.drag=new n.EventEmitter,this.dragEnd=new n.EventEmitter,this.zoomStart=new n.EventEmitter,this.zoomEvt=new n.EventEmitter,this.zoomEnd=new n.EventEmitter,this.rotateStart=new n.EventEmitter,this.rotate=new n.EventEmitter,this.rotateEnd=new n.EventEmitter,this.pitchStart=new n.EventEmitter,this.pitchEvt=new n.EventEmitter,this.pitchEnd=new n.EventEmitter,this.boxZoomStart=new n.EventEmitter,this.boxZoomEnd=new n.EventEmitter,this.boxZoomCancel=new n.EventEmitter,this.webGlContextLost=new n.EventEmitter,this.webGlContextRestored=new n.EventEmitter,this.load=new n.EventEmitter,this.render=new n.EventEmitter,this.error=new n.EventEmitter,this.data=new n.EventEmitter,this.styleData=new n.EventEmitter,this.sourceData=new n.EventEmitter,this.dataLoading=new n.EventEmitter,this.styleDataLoading=new n.EventEmitter,this.sourceDataLoading=new n.EventEmitter}return Object.defineProperty(t.prototype,"mapInstance",{get:function(){return this.MapService.mapInstance},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){this.MapService.setup({accessToken:this.accessToken,customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{container:this.mapContainer.nativeElement,minZoom:this.minZoom,maxZoom:this.maxZoom,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,classes:this.classes,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest},mapEvents:this}),this.cursorStyle&&this.MapService.changeCanvasCursor(this.cursorStyle)},t.prototype.ngOnDestroy=function(){this.MapService.destroyMap()},t.prototype.ngOnChanges=function(t){t.cursorStyle&&!t.cursorStyle.isFirstChange()&&this.MapService.changeCanvasCursor(t.cursorStyle.currentValue),t.minZoom&&!t.minZoom.isFirstChange()&&this.MapService.updateMinZoom(t.minZoom.currentValue),t.maxZoom&&!t.maxZoom.isFirstChange()&&this.MapService.updateMaxZoom(t.maxZoom.currentValue),t.scrollZoom&&!t.scrollZoom.isFirstChange()&&this.MapService.updateScrollZoom(t.scrollZoom.currentValue),t.dragRotate&&!t.dragRotate.isFirstChange()&&this.MapService.updateDragRotate(t.dragRotate.currentValue),t.touchZoomRotate&&!t.touchZoomRotate.isFirstChange()&&this.MapService.updateTouchZoomRotate(t.touchZoomRotate.currentValue),t.doubleClickZoom&&!t.doubleClickZoom.isFirstChange()&&this.MapService.updateDoubleClickZoom(t.doubleClickZoom.currentValue),t.keyboard&&!t.keyboard.isFirstChange()&&this.MapService.updateKeyboard(t.keyboard.currentValue),t.dragPan&&!t.dragPan.isFirstChange()&&this.MapService.updateDragPan(t.dragPan.currentValue),t.boxZoom&&!t.boxZoom.isFirstChange()&&this.MapService.updateBoxZoom(t.boxZoom.currentValue),t.style&&!t.style.isFirstChange()&&this.MapService.updateStyle(t.style.currentValue),t.maxBounds&&!t.maxBounds.isFirstChange()&&this.MapService.updateMaxBounds(t.maxBounds.currentValue),t.fitBounds&&!t.fitBounds.isFirstChange()&&this.MapService.fitBounds(t.fitBounds.currentValue,this.fitBoundsOptions),!this.centerWithPanTo||!t.center||t.center.isFirstChange()||t.zoom||t.bearing||t.pitch?(t.center&&!t.center.isFirstChange()||t.zoom&&!t.zoom.isFirstChange()||t.bearing&&!t.bearing.isFirstChange()||t.pitch&&!t.pitch.isFirstChange())&&this.MapService.move(this.movingMethod,this.flyToOptions,t.zoom&&this.zoom?this.zoom[0]:undefined,t.center?this.center:undefined,t.bearing&&this.bearing?this.bearing[0]:undefined,t.pitch&&this.pitch?this.pitch[0]:undefined):this.MapService.panTo(this.center)},t}();P.decorators=[{type:n.Component,args:[{selector:"mgl-map",template:"<div #container></div>",styles:["\n  :host {\n    display: block;\n  }\n  div {\n    height: 100%;\n    width: 100%;\n  }\n  "],providers:[C],changeDetection:n.ChangeDetectionStrategy.OnPush}]}],P.ctorParameters=function(){return[{type:C}]},P.propDecorators={accessToken:[{type:n.Input}],customMapboxApiUrl:[{type:n.Input}],hash:[{type:n.Input}],refreshExpiredTiles:[{type:n.Input}],failIfMajorPerformanceCaveat:[{type:n.Input}],classes:[{type:n.Input}],bearingSnap:[{type:n.Input}],interactive:[{type:n.Input}],pitchWithRotate:[{type:n.Input}],attributionControl:[{type:n.Input}],logoPosition:[{type:n.Input}],maxTileCacheSize:[{type:n.Input}],localIdeographFontFamily:[{type:n.Input}],preserveDrawingBuffer:[{type:n.Input}],renderWorldCopies:[{type:n.Input}],trackResize:[{type:n.Input}],transformRequest:[{type:n.Input}],minZoom:[{type:n.Input}],maxZoom:[{type:n.Input}],scrollZoom:[{type:n.Input}],dragRotate:[{type:n.Input}],touchZoomRotate:[{type:n.Input}],doubleClickZoom:[{type:n.Input}],keyboard:[{type:n.Input}],dragPan:[{type:n.Input}],boxZoom:[{type:n.Input}],style:[{type:n.Input}],center:[{type:n.Input}],maxBounds:[{type:n.Input}],zoom:[{type:n.Input}],bearing:[{type:n.Input}],pitch:[{type:n.Input}],movingMethod:[{type:n.Input}],fitBounds:[{type:n.Input}],fitBoundsOptions:[{type:n.Input}],flyToOptions:[{type:n.Input}],centerWithPanTo:[{type:n.Input}],cursorStyle:[{type:n.Input}],resize:[{type:n.Output}],remove:[{type:n.Output}],mouseDown:[{type:n.Output}],mouseUp:[{type:n.Output}],mouseMove:[{type:n.Output}],click:[{type:n.Output}],dblClick:[{type:n.Output}],mouseEnter:[{type:n.Output}],mouseLeave:[{type:n.Output}],mouseOver:[{type:n.Output}],mouseOut:[{type:n.Output}],contextMenu:[{type:n.Output}],touchStart:[{type:n.Output}],touchEnd:[{type:n.Output}],touchMove:[{type:n.Output}],touchCancel:[{type:n.Output}],moveStart:[{type:n.Output}],move:[{type:n.Output}],moveEnd:[{type:n.Output}],dragStart:[{type:n.Output}],drag:[{type:n.Output}],dragEnd:[{type:n.Output}],zoomStart:[{type:n.Output}],zoomEvt:[{type:n.Output}],zoomEnd:[{type:n.Output}],rotateStart:[{type:n.Output}],rotate:[{type:n.Output}],rotateEnd:[{type:n.Output}],pitchStart:[{type:n.Output}],pitchEvt:[{type:n.Output}],pitchEnd:[{type:n.Output}],boxZoomStart:[{type:n.Output}],boxZoomEnd:[{type:n.Output}],boxZoomCancel:[{type:n.Output}],webGlContextLost:[{type:n.Output}],webGlContextRestored:[{type:n.Output}],load:[{type:n.Output}],render:[{type:n.Output}],error:[{type:n.Output}],data:[{type:n.Output}],styleData:[{type:n.Output}],sourceData:[{type:n.Output}],dataLoading:[{type:n.Output}],styleDataLoading:[{type:n.Output}],sourceDataLoading:[{type:n.Output}],mapContainer:[{type:n.ViewChild,args:["container"]}]};var A=function(){return function(){}}();A.decorators=[{type:n.Directive,args:[{selector:"ng-template[mglPoint]"}]}],A.ctorParameters=function(){return[]};var L=function(){return function(){}}();L.decorators=[{type:n.Directive,args:[{selector:"ng-template[mglClusterPoint]"}]}],L.ctorParameters=function(){return[]};var Z=function(){function t(t,e){this.MapService=t,this.ChangeDetectorRef=e,this.sub=new p.Subscription}return t.prototype.ngOnInit=function(){var t={radius:this.radius,maxZoom:this.maxZoom,minZoom:this.minZoom,extent:this.extent,nodeSize:this.nodeSize,log:this.log,reduce:this.reduce,initial:this.initial,map:this.map};Object.keys(t).forEach(function(e){var n=e;t[n]===undefined&&delete t[n]}),this.supercluster=l(t),this.supercluster.load(this.data.features)},t.prototype.ngOnChanges=function(t){t.data&&!t.data.isFirstChange()&&this.supercluster.load(this.data.features)},t.prototype.ngAfterContentInit=function(){var t=this;this.MapService.mapCreated$.subscribe(function(){var e=m.merge(c.fromEvent(t.MapService.mapInstance,"zoomChange"),c.fromEvent(t.MapService.mapInstance,"move")).pipe(h.startWith(undefined)).subscribe(function(){return t.updateCluster()});t.sub.add(e)})},t.prototype.ngOnDestroy=function(){this.sub.unsubscribe()},t.prototype.updateCluster=function(){var t=this.MapService.getCurrentViewportBbox(),e=Math.round(this.MapService.mapInstance.getZoom());this.clusterPoints=this.supercluster.getClusters(t,e),this.ChangeDetectorRef.detectChanges(),this.MapService.applyChanges()},t}();Z.decorators=[{type:n.Component,args:[{selector:"mgl-marker-cluster",template:'\n    <ng-container *ngFor="let feature of clusterPoints">\n      <ng-container *ngIf="feature.properties.cluster; else point">\n        <mgl-marker\n          [feature]="feature"\n        >\n          <ng-container *ngTemplateOutlet="clusterPointTpl; context: { $implicit: feature }"></ng-container>\n        </mgl-marker>\n      </ng-container>\n      <ng-template #point>\n        <mgl-marker\n          [feature]="feature"\n        >\n          <ng-container *ngTemplateOutlet="pointTpl; context: { $implicit: feature }"></ng-container>\n        </mgl-marker>\n      </ng-template>\n    </ng-container>\n  ',changeDetection:n.ChangeDetectionStrategy.OnPush,preserveWhitespaces:!1}]}],Z.ctorParameters=function(){return[{type:C},{type:n.ChangeDetectorRef}]},Z.propDecorators={radius:[{type:n.Input}],maxZoom:[{type:n.Input}],minZoom:[{type:n.Input}],extent:[{type:n.Input}],nodeSize:[{type:n.Input}],log:[{type:n.Input}],reduce:[{type:n.Input}],initial:[{type:n.Input}],map:[{type:n.Input}],data:[{type:n.Input}],pointTpl:[{type:n.ContentChild,args:[A,{read:n.TemplateRef}]}],clusterPointTpl:[{type:n.ContentChild,args:[L,{read:n.TemplateRef}]}]};var F=function(){function t(t){this.MapService=t}return t.prototype.ngOnInit=function(){if(this.feature&&this.lngLat)throw new Error("feature and lngLat input are mutually exclusive")},t.prototype.ngOnChanges=function(t){t.lngLat&&!t.lngLat.isFirstChange()&&this.markerInstance.setLngLat(this.lngLat),t.feature&&!t.feature.isFirstChange()&&this.markerInstance.setLngLat(this.feature.geometry.coordinates)},t.prototype.ngAfterViewInit=function(){var t=this;this.markerInstance=new o.Marker(this.content.nativeElement,{offset:this.offset}),this.markerInstance.setLngLat(this.feature?this.feature.geometry.coordinates:this.lngLat),this.MapService.mapCreated$.subscribe(function(){t.MapService.addMarker(t.markerInstance)})},t.prototype.ngOnDestroy=function(){this.MapService.removeMarker(this.markerInstance),this.markerInstance=undefined},t.prototype.togglePopup=function(){this.markerInstance.togglePopup()},t}();F.decorators=[{type:n.Component,args:[{selector:"mgl-marker",template:"<div #content><ng-content></ng-content></div>",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],F.ctorParameters=function(){return[{type:C}]},F.propDecorators={offset:[{type:n.Input}],feature:[{type:n.Input}],lngLat:[{type:n.Input}],content:[{type:n.ViewChild,args:["content"]}]};var R=function(){function t(t){this.MapService=t,this.close=new n.EventEmitter}return t.prototype.ngOnInit=function(){if(this.lngLat&&this.marker)throw new Error("marker and lngLat input are mutually exclusive")},t.prototype.ngOnChanges=function(t){if(t.lngLat&&!t.lngLat.isFirstChange()){this.MapService.removePopup(this.popupInstance);var e=this.createPopup();this.MapService.addPopup(e),this.popupInstance=e}if(t.marker&&!t.marker.isFirstChange()){var n=t.marker.previousValue;n.markerInstance&&n.markerInstance.setPopup(undefined),this.marker&&this.marker.markerInstance&&this.marker.markerInstance.setPopup(this.popupInstance)}},t.prototype.ngAfterViewInit=function(){this.popupInstance=this.createPopup()},t.prototype.ngOnDestroy=function(){this.MapService.removePopup(this.popupInstance),this.popupInstance=undefined},t.prototype.createPopup=function(){var t=this,e={closeButton:this.closeButton,closeOnClick:this.closeOnClick,anchor:this.anchor,offset:this.offset};Object.keys(e).forEach(function(t){return e[t]===undefined&&delete e[t]});var n=new o.Popup(e);return n.once("close",function(){t.close.emit()}),n.setDOMContent(this.content.nativeElement),this.MapService.mapCreated$.subscribe(function(){t.lngLat?(n.setLngLat(t.lngLat),t.MapService.addPopup(n)):t.marker&&t.marker.markerInstance&&t.marker.markerInstance.setPopup(n)}),n},t}();R.decorators=[{type:n.Component,args:[{selector:"mgl-popup",template:"<div #content><ng-content></ng-content></div>",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],R.ctorParameters=function(){return[{type:C}]},R.propDecorators={closeButton:[{type:n.Input}],closeOnClick:[{type:n.Input}],anchor:[{type:n.Input}],offset:[{type:n.Input}],lngLat:[{type:n.Input}],marker:[{type:n.Input}],close:[{type:n.Output}],content:[{type:n.ViewChild,args:["content"]}]};var j=function(){function t(t){this.MapService=t,this.sourceAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){var e={type:"canvas",coordinates:t.coordinates,canvas:t.canvas,animate:t.animate};t.MapService.addSource(t.id,e),t.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.coordinates&&!t.coordinates.isFirstChange()||t.canvas&&!t.canvas.isFirstChange()||t.animate&&!t.animate.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sourceAdded&&this.MapService.removeSource(this.id)},t}();j.decorators=[{type:n.Component,args:[{selector:"mgl-canvas-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],j.ctorParameters=function(){return[{type:C}]},j.propDecorators={id:[{type:n.Input}],coordinates:[{type:n.Input}],canvas:[{type:n.Input}],animate:[{type:n.Input}]};var T=function(){function t(t){this.MapService=t,this.updateFeatureData=new g.Subject,this.sourceAdded=!1,this.featureIdCounter=0}return t.prototype.ngOnInit=function(){var t=this;this.data||(this.data={type:"FeatureCollection",features:[]}),this.MapService.mapLoaded$.subscribe(function(){t.MapService.addSource(t.id,{type:"geojson",data:t.data,maxzoom:t.maxzoom,minzoom:t.minzoom,buffer:t.buffer,tolerance:t.tolerance,cluster:t.cluster,clusterRadius:t.clusterRadius,clusterMaxZoom:t.clusterMaxZoom}),t.sub=t.updateFeatureData.pipe(y.debounceTime(0)).subscribe(function(){t.MapService.getSource(t.id).setData(t.data)}),t.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&((t.maxzoom&&!t.maxzoom.isFirstChange()||t.minzoom&&!t.minzoom.isFirstChange()||t.buffer&&!t.buffer.isFirstChange()||t.tolerance&&!t.tolerance.isFirstChange()||t.cluster&&!t.cluster.isFirstChange()||t.clusterRadius&&!t.clusterRadius.isFirstChange()||t.clusterMaxZoom&&!t.clusterMaxZoom.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit()),t.data&&!t.data.isFirstChange()&&this.MapService.getSource(this.id).setData(this.data))},t.prototype.ngOnDestroy=function(){this.sourceAdded&&(this.sub.unsubscribe(),this.MapService.removeSource(this.id))},t.prototype.addFeature=function(t){this.data.features.push(t),this.updateFeatureData.next()},t.prototype.removeFeature=function(t){var e=this.data,n=e.features.indexOf(t);n>-1&&e.features.splice(n,1),this.updateFeatureData.next()},t.prototype.getNewFeatureId=function(){return++this.featureIdCounter},t}();T.decorators=[{type:n.Component,args:[{selector:"mgl-geojson-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],T.ctorParameters=function(){return[{type:C}]},T.propDecorators={id:[{type:n.Input}],data:[{type:n.Input}],minzoom:[{type:n.Input}],maxzoom:[{type:n.Input}],buffer:[{type:n.Input}],tolerance:[{type:n.Input}],cluster:[{type:n.Input}],clusterRadius:[{type:n.Input}],clusterMaxZoom:[{type:n.Input}]};var B=function(){function t(t){this.GeoJSONSourceComponent=t,this.type="Feature"}return t.prototype.ngOnInit=function(){this.id||(this.id=this.GeoJSONSourceComponent.getNewFeatureId()),this.feature={type:this.type,geometry:this.geometry,properties:this.properties?this.properties:{}},this.feature.id=this.id,this.GeoJSONSourceComponent.addFeature(this.feature)},t.prototype.ngOnDestroy=function(){this.GeoJSONSourceComponent.removeFeature(this.feature)},t.prototype.updateCoordinates=function(t){this.feature.geometry.coordinates=t,this.GeoJSONSourceComponent.updateFeatureData.next()},t}();B.decorators=[{type:n.Component,args:[{selector:"mgl-feature",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],B.ctorParameters=function(){return[{type:T,decorators:[{type:n.Inject,args:[n.forwardRef(function(){return T})]}]}]},B.propDecorators={id:[{type:n.Input}],geometry:[{type:n.Input}],properties:[{type:n.Input}]};var $=function(){function t(t,e,o){this.MapService=t,this.FeatureComponent=e,this.NgZone=o,this.dragStart=new n.EventEmitter,this.dragEnd=new n.EventEmitter,this.drag=new n.EventEmitter,this.destroyed$=new f.ReplaySubject(1)}return t.prototype.ngOnInit=function(){var t=this;if("Point"!==this.FeatureComponent.geometry.type)throw new Error("mglDraggable only support point feature");this.MapService.mapCreated$.subscribe(function(){t.source.mouseEnter.pipe(d.takeUntil(t.destroyed$)).subscribe(function(e){t.MapService.queryRenderedFeatures(e.point,{layers:[t.source.id],filter:["all",["==","$type","Point"],["==","$id",t.FeatureComponent.id]]})[0]&&(t.MapService.changeCanvasCursor("move"),t.MapService.updateDragPan(!1),c.fromEvent(t.MapService.mapInstance,"mousedown").pipe(d.takeUntil(m.merge(t.destroyed$,t.source.mouseLeave))).subscribe(function(){t.dragStart.observers.length&&t.NgZone.run(function(){return t.dragStart.emit(e)}),c.fromEvent(t.MapService.mapInstance,"mousemove").pipe(d.takeUntil(m.merge(t.destroyed$,c.fromEvent(t.MapService.mapInstance,"mouseup")))).subscribe(function(e){t.drag.observers.length&&t.NgZone.run(function(){return t.drag.emit(e)}),t.FeatureComponent.updateCoordinates([e.lngLat.lng,e.lngLat.lat])},function(t){return t},function(){t.dragEnd.observers.length&&t.NgZone.run(function(){return t.dragEnd.emit(e)})})}))}),t.source.mouseLeave.pipe(d.takeUntil(t.destroyed$)).subscribe(function(){t.MapService.changeCanvasCursor(""),t.MapService.updateDragPan(!0)})})},t.prototype.ngOnDestroy=function(){this.destroyed$.next(undefined),this.destroyed$.complete()},t}();$.decorators=[{type:n.Directive,args:[{selector:"[mglDraggable]"}]}],$.ctorParameters=function(){return[{type:C},{type:B,decorators:[{type:n.Host}]},{type:n.NgZone}]},$.propDecorators={source:[{type:n.Input,args:["mglDraggable"]}],dragStart:[{type:n.Output}],dragEnd:[{type:n.Output}],drag:[{type:n.Output}]};var V=function(){function t(t){this.MapService=t,this.sourceAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){t.MapService.addSource(t.id,{type:"image",url:t.url,coordinates:t.coordinates}),t.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.url&&!t.url.isFirstChange()||t.coordinates&&!t.coordinates.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sourceAdded&&this.MapService.removeSource(this.id)},t}();V.decorators=[{type:n.Component,args:[{selector:"mgl-image-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],V.ctorParameters=function(){return[{type:C}]},V.propDecorators={id:[{type:n.Input}],url:[{type:n.Input}],coordinates:[{type:n.Input}]};var q=function(){function t(t){this.MapService=t,this.type="raster",this.sourceAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){var e={type:t.type,url:t.url,tiles:t.tiles,bounds:t.bounds,minzoom:t.minzoom,maxzoom:t.maxzoom,tileSize:t.tileSize};t.MapService.addSource(t.id,e),t.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.url&&!t.url.isFirstChange()||t.tiles&&!t.tiles.isFirstChange()||t.bounds&&!t.bounds.isFirstChange()||t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange()||t.tileSize&&!t.tileSize.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sourceAdded&&this.MapService.removeSource(this.id)},t}();q.decorators=[{type:n.Component,args:[{selector:"mgl-raster-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],q.ctorParameters=function(){return[{type:C}]},q.propDecorators={id:[{type:n.Input}],url:[{type:n.Input}],tiles:[{type:n.Input}],bounds:[{type:n.Input}],minzoom:[{type:n.Input}],maxzoom:[{type:n.Input}],tileSize:[{type:n.Input}]};var N=function(){function t(t){this.MapService=t,this.type="vector",this.sourceAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){t.MapService.addSource(t.id,{type:t.type,url:t.url,tiles:t.tiles,minzoom:t.minzoom,maxzoom:t.maxzoom}),t.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.url&&!t.url.isFirstChange()||t.tiles&&!t.tiles.isFirstChange()||t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sourceAdded&&this.MapService.removeSource(this.id)},t}();N.decorators=[{type:n.Component,args:[{selector:"mgl-vector-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],N.ctorParameters=function(){return[{type:C}]},N.propDecorators={id:[{type:n.Input}],url:[{type:n.Input}],tiles:[{type:n.Input}],minzoom:[{type:n.Input}],maxzoom:[{type:n.Input}]};var U=function(){function t(t){this.MapService=t,this.sourceAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){t.MapService.addSource(t.id,{type:"video",urls:t.urls,coordinates:t.coordinates}),t.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.urls&&!t.urls.isFirstChange()||t.coordinates&&!t.coordinates.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sourceAdded&&this.MapService.removeSource(this.id)},t}();U.decorators=[{type:n.Component,args:[{selector:"mgl-video-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],U.ctorParameters=function(){return[{type:C}]},U.propDecorators={id:[{type:n.Input}],urls:[{type:n.Input}],coordinates:[{type:n.Input}]};var G=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[{provide:I,useValue:e.accessToken}]}},t}();G.decorators=[{type:n.NgModule,args:[{imports:[e.CommonModule],declarations:[P,D,$,k,N,T,q,V,U,j,B,F,R,O,x,z,M,E,w,A,L,Z],exports:[P,D,$,k,N,T,q,V,U,j,B,F,R,O,x,z,M,E,w,A,L,Z]}]}],G.ctorParameters=function(){return[]},t.NgxMapboxGLModule=G,t.MAPBOX_API_KEY=I,t.MapService=C,t.MapComponent=P,t.ɵq=E,t.ɵm=O,t.ɵn=x,t.ɵp=M,t.ɵo=z,t.ɵr=w,t.ɵe=k,t.ɵa=D,t.ɵt=L,t.ɵu=Z,t.ɵs=A,t.ɵk=F,t.ɵl=R,t.ɵj=j,t.ɵb=$,t.ɵc=B,t.ɵd=T,t.ɵh=V,t.ɵg=q,t.ɵf=N,t.ɵi=U,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-mapbox-gl.umd.min.js.map
